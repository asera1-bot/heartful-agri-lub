2026-02-15 14:06:57,527 | INFO | harvet_etl | start csv=test.csv
2026-02-15 14:06:59,528 | ERROR | harvet_etl | failed vsv=test.csv reason=/mnt/csv/test.csv
Traceback (most recent call last):
  File "/app/etl/harvest/run.py", line 53, in run
    with_retry(process)
  File "/app/etl/common/retry.py", line 6, in with_retry
    return func()
           ^^^^^^
  File "/app/etl/harvest/run.py", line 30, in process
    df = extract_csv(csv_path)
         ^^^^^^^^^^^^^^^^^^^^^
  File "/app/etl/harvest/extract.py", line 47, in extract_csv
    raise FileNotFoundError(str(path))
FileNotFoundError: /mnt/csv/test.csv
2026-02-15 14:07:59,146 | INFO | harvet_etl | start csv=test.csv
2026-02-15 14:08:01,148 | ERROR | harvet_etl | failed vsv=test.csv reason=/mnt/csv/test.csv
Traceback (most recent call last):
  File "/app/etl/harvest/run.py", line 53, in run
    with_retry(process)
  File "/app/etl/common/retry.py", line 6, in with_retry
    return func()
           ^^^^^^
  File "/app/etl/harvest/run.py", line 30, in process
    df = extract_csv(csv_path)
         ^^^^^^^^^^^^^^^^^^^^^
  File "/app/etl/harvest/extract.py", line 47, in extract_csv
    raise FileNotFoundError(str(path))
FileNotFoundError: /mnt/csv/test.csv
2026-02-15 14:08:01,150 | INFO | harvet_etl | ETL finished ok=0 ng=1
2026-02-15 14:16:02,969 | INFO | harvet_etl | start csv=test.csv
2026-02-15 14:16:04,971 | ERROR | harvet_etl | failed vsv=test.csv reason=/mnt/csv/test.csv
Traceback (most recent call last):
  File "/app/etl/harvest/run.py", line 53, in run
    with_retry(process)
  File "/app/etl/common/retry.py", line 6, in with_retry
    return func()
           ^^^^^^
  File "/app/etl/harvest/run.py", line 30, in process
    df = extract_csv(csv_path)
         ^^^^^^^^^^^^^^^^^^^^^
  File "/app/etl/harvest/extract.py", line 47, in extract_csv
    raise FileNotFoundError(str(path))
FileNotFoundError: /mnt/csv/test.csv
2026-02-15 14:16:04,973 | INFO | harvet_etl | ETL finished ok=0 ng=1
2026-02-15 14:22:16,926 | INFO | harvet_etl | start csv=test.csv
2026-02-15 14:22:16,943 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-15 14:22:16,944 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-15 14:22:16,954 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-15 14:22:17,956 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-15 14:22:17,957 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-15 14:22:17,961 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-15 14:22:18,963 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-15 14:22:18,964 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-15 14:22:18,967 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-15 14:22:18,968 | ERROR | harvet_etl | failed vsv=test.csv reason=name 'rename_colmuns' is not defined
Traceback (most recent call last):
  File "/app/etl/harvest/run.py", line 53, in run
    with_retry(process)
  File "/app/etl/common/retry.py", line 6, in with_retry
    return func()
           ^^^^^^
  File "/app/etl/harvest/run.py", line 35, in process
    df = df.rename(colmap=rename_colmuns(list(df.colmuns)))
                          ^^^^^^^^^^^^^^
NameError: name 'rename_colmuns' is not defined. Did you mean: 'rename_columns'?
2026-02-15 14:22:18,970 | INFO | harvet_etl | ETL finished ok=0 ng=1
2026-02-15 14:22:44,201 | INFO | harvet_etl | start csv=test.csv
2026-02-15 14:22:44,202 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-15 14:22:44,203 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-15 14:22:44,205 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-15 14:22:45,207 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-15 14:22:45,208 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-15 14:22:45,212 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-15 14:22:46,213 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-15 14:22:46,215 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-15 14:22:46,218 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-15 14:22:46,218 | ERROR | harvet_etl | failed vsv=test.csv reason='DataFrame' object has no attribute 'colmuns'
Traceback (most recent call last):
  File "/app/etl/harvest/run.py", line 53, in run
    with_retry(process)
  File "/app/etl/common/retry.py", line 6, in with_retry
    return func()
           ^^^^^^
  File "/app/etl/harvest/run.py", line 35, in process
    df = df.rename(colmap=rename_columns(list(df.colmuns)))
                                              ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/pandas/core/generic.py", line 6206, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'DataFrame' object has no attribute 'colmuns'. Did you mean: 'columns'?
2026-02-15 14:22:46,231 | INFO | harvet_etl | ETL finished ok=0 ng=1
2026-02-15 14:23:32,060 | INFO | harvet_etl | start csv=test.csv
2026-02-15 14:23:32,062 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-15 14:23:32,063 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-15 14:23:32,066 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-15 14:23:33,068 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-15 14:23:33,069 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-15 14:23:33,071 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-15 14:23:34,073 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-15 14:23:34,074 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-15 14:23:34,077 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-15 14:23:34,078 | ERROR | harvet_etl | failed vsv=test.csv reason='_SpecialGenericAlias' object does not support item assignment
Traceback (most recent call last):
  File "/app/etl/harvest/run.py", line 53, in run
    with_retry(process)
  File "/app/etl/common/retry.py", line 6, in with_retry
    return func()
           ^^^^^^
  File "/app/etl/harvest/run.py", line 35, in process
    df = df.rename(colmap=rename_columns(list(df.columns)))
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/etl/harvest/colmap.py", line 30, in rename_columns
    mapping = Dict[str, str] = {}
              ~~~~^^^^^^^^^^
TypeError: '_SpecialGenericAlias' object does not support item assignment
2026-02-15 14:23:34,079 | INFO | harvet_etl | ETL finished ok=0 ng=1
2026-02-15 14:24:18,435 | INFO | harvet_etl | start csv=test.csv
2026-02-15 14:24:18,437 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-15 14:24:18,438 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-15 14:24:18,440 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-15 14:24:19,442 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-15 14:24:19,443 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-15 14:24:19,446 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-15 14:24:20,448 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-15 14:24:20,450 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-15 14:24:20,451 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-15 14:24:20,452 | ERROR | harvet_etl | failed vsv=test.csv reason='_SpecialGenericAlias' object does not support item assignment
Traceback (most recent call last):
  File "/app/etl/harvest/run.py", line 53, in run
    with_retry(process)
  File "/app/etl/common/retry.py", line 6, in with_retry
    return func()
           ^^^^^^
  File "/app/etl/harvest/run.py", line 35, in process
    df = df.rename(colmap=rename_columns(list(df.columns)))
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/etl/harvest/colmap.py", line 30, in rename_columns
    mapping = Dict[str] = {}
              ~~~~^^^^^
TypeError: '_SpecialGenericAlias' object does not support item assignment
2026-02-15 14:24:20,453 | INFO | harvet_etl | ETL finished ok=0 ng=1
2026-02-15 14:25:28,395 | INFO | harvet_etl | start csv=test.csv
2026-02-15 14:25:28,397 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-15 14:25:28,398 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-15 14:25:28,400 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-15 14:25:29,403 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-15 14:25:29,404 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-15 14:25:29,407 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-15 14:25:30,409 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-15 14:25:30,411 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-15 14:25:30,413 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-15 14:25:30,414 | ERROR | harvet_etl | failed vsv=test.csv reason=DataFrame.rename() got an unexpected keyword argument 'colmap'
Traceback (most recent call last):
  File "/app/etl/harvest/run.py", line 53, in run
    with_retry(process)
  File "/app/etl/common/retry.py", line 6, in with_retry
    return func()
           ^^^^^^
  File "/app/etl/harvest/run.py", line 35, in process
    df = df.rename(colmap=rename_columns(list(df.columns)))
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: DataFrame.rename() got an unexpected keyword argument 'colmap'
2026-02-15 14:25:30,415 | INFO | harvet_etl | ETL finished ok=0 ng=1
2026-02-15 14:26:47,256 | INFO | harvet_etl | start csv=test.csv
2026-02-15 14:26:47,258 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-15 14:26:47,259 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-15 14:26:47,261 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-15 14:26:48,263 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-15 14:26:48,264 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-15 14:26:48,267 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-15 14:26:49,269 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-15 14:26:49,270 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-15 14:26:49,273 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-15 14:26:49,273 | ERROR | harvet_etl | failed vsv=test.csv reason=DataFrame.rename() got an unexpected keyword argument 'colmumns'
Traceback (most recent call last):
  File "/app/etl/harvest/run.py", line 53, in run
    with_retry(process)
  File "/app/etl/common/retry.py", line 6, in with_retry
    return func()
           ^^^^^^
  File "/app/etl/harvest/run.py", line 35, in process
    df = df.rename(colmumns=rename_columns(list(df.columns)))
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: DataFrame.rename() got an unexpected keyword argument 'colmumns'
2026-02-15 14:26:49,274 | INFO | harvet_etl | ETL finished ok=0 ng=1
2026-02-15 14:27:08,551 | INFO | harvet_etl | start csv=test.csv
2026-02-15 14:27:08,553 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-15 14:27:08,554 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-15 14:27:08,556 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-15 14:27:09,562 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-15 14:27:09,564 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-15 14:27:09,567 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-15 14:27:10,570 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-15 14:27:10,571 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-15 14:27:10,574 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-15 14:27:10,576 | ERROR | harvet_etl | failed vsv=test.csv reason=to_datetime() got an unexpected keyword argument 'error'
Traceback (most recent call last):
  File "/app/etl/harvest/run.py", line 53, in run
    with_retry(process)
  File "/app/etl/common/retry.py", line 6, in with_retry
    return func()
           ^^^^^^
  File "/app/etl/harvest/run.py", line 36, in process
    df = normalize_values(df)
         ^^^^^^^^^^^^^^^^^^^^
  File "/app/etl/harvest/colmap.py", line 44, in normalize_values
    dt = pd.to_datetime(s, error="coerce", infer_datetime_format=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: to_datetime() got an unexpected keyword argument 'error'
2026-02-15 14:27:10,577 | INFO | harvet_etl | ETL finished ok=0 ng=1
2026-02-15 14:28:32,739 | INFO | harvet_etl | start csv=test.csv
2026-02-15 14:28:32,741 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-15 14:28:32,741 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-15 14:28:32,743 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-15 14:28:33,747 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-15 14:28:33,749 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-15 14:28:33,752 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-15 14:28:34,755 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-15 14:28:34,756 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-15 14:28:34,759 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-15 14:28:34,760 | ERROR | harvet_etl | failed vsv=test.csv reason=to_datetime() got an unexpected keyword argument 'infer_datetime_format'
Traceback (most recent call last):
  File "/app/etl/harvest/run.py", line 53, in run
    with_retry(process)
  File "/app/etl/common/retry.py", line 6, in with_retry
    return func()
           ^^^^^^
  File "/app/etl/harvest/run.py", line 36, in process
    df = normalize_values(df)
         ^^^^^^^^^^^^^^^^^^^^
  File "/app/etl/harvest/colmap.py", line 44, in normalize_values
    dt = pd.to_datetime(s, errors="coerce", infer_datetime_format=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: to_datetime() got an unexpected keyword argument 'infer_datetime_format'
2026-02-15 14:28:34,761 | INFO | harvet_etl | ETL finished ok=0 ng=1
2026-02-15 14:32:15,707 | INFO | harvet_etl | start csv=test.csv
2026-02-15 14:32:15,708 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-15 14:32:15,709 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-15 14:32:15,712 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-15 14:32:16,715 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-15 14:32:16,717 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-15 14:32:16,719 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-15 14:32:17,722 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-15 14:32:17,723 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-15 14:32:17,726 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-15 14:32:17,728 | ERROR | harvet_etl | failed vsv=test.csv reason=to_datetime() got an unexpected keyword argument 'uearfirst'
Traceback (most recent call last):
  File "/app/etl/harvest/run.py", line 53, in run
    with_retry(process)
  File "/app/etl/common/retry.py", line 6, in with_retry
    return func()
           ^^^^^^
  File "/app/etl/harvest/run.py", line 36, in process
    df = normalize_values(df)
         ^^^^^^^^^^^^^^^^^^^^
  File "/app/etl/harvest/colmap.py", line 44, in normalize_values
    dt = pd.to_datetime(s, errors="coerce", uearfirst=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: to_datetime() got an unexpected keyword argument 'uearfirst'
2026-02-15 14:32:17,729 | INFO | harvet_etl | ETL finished ok=0 ng=1
2026-02-15 14:32:35,311 | INFO | harvet_etl | start csv=test.csv
2026-02-15 14:32:35,313 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-15 14:32:35,314 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-15 14:32:35,316 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-15 14:32:36,322 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-15 14:32:36,323 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-15 14:32:36,326 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-15 14:32:37,330 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-15 14:32:37,331 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-15 14:32:37,334 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-15 14:32:37,337 | ERROR | harvet_etl | failed vsv=test.csv reason=name 'strftiime' is not defined
Traceback (most recent call last):
  File "/app/etl/harvest/run.py", line 53, in run
    with_retry(process)
  File "/app/etl/common/retry.py", line 6, in with_retry
    return func()
           ^^^^^^
  File "/app/etl/harvest/run.py", line 36, in process
    df = normalize_values(df)
         ^^^^^^^^^^^^^^^^^^^^
  File "/app/etl/harvest/colmap.py", line 45, in normalize_values
    df["harvest_date"] = strftiime("%Y-%m-%d") # Nat is NaN
                         ^^^^^^^^^
NameError: name 'strftiime' is not defined
2026-02-15 14:32:37,342 | INFO | harvet_etl | ETL finished ok=0 ng=1
2026-02-15 14:32:59,852 | INFO | harvet_etl | start csv=test.csv
2026-02-15 14:32:59,854 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-15 14:32:59,855 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-15 14:32:59,857 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-15 14:33:00,864 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-15 14:33:00,865 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-15 14:33:00,869 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-15 14:33:01,872 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-15 14:33:01,873 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-15 14:33:01,877 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-15 14:33:01,878 | ERROR | harvet_etl | failed vsv=test.csv reason=name 'strftime' is not defined
Traceback (most recent call last):
  File "/app/etl/harvest/run.py", line 53, in run
    with_retry(process)
  File "/app/etl/common/retry.py", line 6, in with_retry
    return func()
           ^^^^^^
  File "/app/etl/harvest/run.py", line 36, in process
    df = normalize_values(df)
         ^^^^^^^^^^^^^^^^^^^^
  File "/app/etl/harvest/colmap.py", line 45, in normalize_values
    df["harvest_date"] = strftime("%Y-%m-%d") # Nat is NaN
                         ^^^^^^^^
NameError: name 'strftime' is not defined
2026-02-15 14:33:01,882 | INFO | harvet_etl | ETL finished ok=0 ng=1
2026-02-15 14:35:21,540 | INFO | harvet_etl | start csv=test.csv
2026-02-15 14:35:21,542 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-15 14:35:21,543 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-15 14:35:21,545 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-15 14:35:22,551 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-15 14:35:22,552 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-15 14:35:22,555 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-15 14:35:23,559 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-15 14:35:23,560 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-15 14:35:23,563 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-15 14:35:23,566 | ERROR | harvet_etl | failed vsv=test.csv reason=to_numeric() got an unexpected keyword argument 'error'
Traceback (most recent call last):
  File "/app/etl/harvest/run.py", line 53, in run
    with_retry(process)
  File "/app/etl/common/retry.py", line 6, in with_retry
    return func()
           ^^^^^^
  File "/app/etl/harvest/run.py", line 36, in process
    df = normalize_values(df)
         ^^^^^^^^^^^^^^^^^^^^
  File "/app/etl/harvest/colmap.py", line 49, in normalize_values
    df["amount_g"] = pd.to_numeric(df["amount_g"], error="coerce")
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: to_numeric() got an unexpected keyword argument 'error'
2026-02-15 14:35:23,568 | INFO | harvet_etl | ETL finished ok=0 ng=1
2026-02-15 14:35:55,026 | INFO | harvet_etl | start csv=test.csv
2026-02-15 14:35:55,028 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-15 14:35:55,029 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-15 14:35:55,031 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-15 14:35:56,041 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-15 14:35:56,042 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-15 14:35:56,046 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-15 14:35:57,051 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-15 14:35:57,052 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-15 14:35:57,055 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-15 14:35:57,059 | ERROR | harvet_etl | failed vsv=test.csv reason=etl.harvest.schema.HarvestCsvRow() argument after ** must be a mapping, not str
Traceback (most recent call last):
  File "/app/etl/harvest/run.py", line 53, in run
    with_retry(process)
  File "/app/etl/common/retry.py", line 6, in with_retry
    return func()
           ^^^^^^
  File "/app/etl/harvest/run.py", line 39, in process
    ok_rows, quarantine_rows = validate_rows(df) # validate.pyをtuple返却に変更する前提
                               ^^^^^^^^^^^^^^^^^
  File "/app/etl/harvest/validate.py", line 27, in validate_rows
    ok.append(HarvestCsvRow(**rec))
              ^^^^^^^^^^^^^^^^^^^^
TypeError: etl.harvest.schema.HarvestCsvRow() argument after ** must be a mapping, not str
2026-02-15 14:35:57,063 | INFO | harvet_etl | ETL finished ok=0 ng=1
2026-02-15 14:41:34,476 | INFO | harvet_etl | start csv=test.csv
2026-02-15 14:41:34,478 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-15 14:41:34,479 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-15 14:41:34,480 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-15 14:41:34,490 | INFO | harvest_etl | validate done ok=2 quarantine=0
2026-02-15 14:41:34,490 | INFO | harvest_etl | quarantine load skipped: rows is empty
2026-02-15 14:41:34,490 | INFO | harvet_etl | rows summary csv=test.csv df=2ok=2 quarantine=0
2026-02-15 14:41:34,636 | INFO | harvest_etl | upserted rows=2
2026-02-15 14:41:34,636 | INFO | harvet_etl | success csv=test.csv
2026-02-15 14:41:34,636 | INFO | harvet_etl | ETL finished ok=1 ng=0
2026-02-16 08:51:41,454 | INFO | harvet_etl | start csv=test.csv
2026-02-16 08:51:43,455 | ERROR | harvet_etl | failed vsv=test.csv reason=/mnt/csv/test.csv
Traceback (most recent call last):
  File "/app/etl/harvest/run.py", line 53, in run
    with_retry(process)
  File "/app/etl/common/retry.py", line 6, in with_retry
    return func()
           ^^^^^^
  File "/app/etl/harvest/run.py", line 30, in process
    df = extract_csv(csv_path)
         ^^^^^^^^^^^^^^^^^^^^^
  File "/app/etl/harvest/extract.py", line 47, in extract_csv
    raise FileNotFoundError(str(path))
FileNotFoundError: /mnt/csv/test.csv
2026-02-16 08:51:43,456 | INFO | harvet_etl | ETL finished ok=0 ng=1
2026-02-16 08:55:05,132 | INFO | harvet_etl | start csv=test.csv
2026-02-16 08:55:05,136 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-16 08:55:05,137 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-16 08:55:05,143 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-16 08:55:05,148 | INFO | harvest_etl | validate done ok=2 quarantine=0
2026-02-16 08:55:05,148 | INFO | harvest_etl | quarantine load skipped: rows is empty
2026-02-16 08:55:05,148 | INFO | harvet_etl | rows summary csv=test.csv df=2ok=2 quarantine=0
2026-02-16 08:55:06,301 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-16 08:55:06,302 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-16 08:55:06,303 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-16 08:55:06,305 | INFO | harvest_etl | validate done ok=2 quarantine=0
2026-02-16 08:55:06,305 | INFO | harvest_etl | quarantine load skipped: rows is empty
2026-02-16 08:55:06,305 | INFO | harvet_etl | rows summary csv=test.csv df=2ok=2 quarantine=0
2026-02-16 08:55:07,325 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-16 08:55:07,326 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-16 08:55:07,327 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-16 08:55:07,329 | INFO | harvest_etl | validate done ok=2 quarantine=0
2026-02-16 08:55:07,329 | INFO | harvest_etl | quarantine load skipped: rows is empty
2026-02-16 08:55:07,329 | INFO | harvet_etl | rows summary csv=test.csv df=2ok=2 quarantine=0
2026-02-16 08:55:07,348 | ERROR | harvet_etl | failed vsv=test.csv reason=harvest
Traceback (most recent call last):
  File "/app/etl/harvest/run.py", line 53, in run
    with_retry(process)
  File "/app/etl/common/retry.py", line 6, in with_retry
    return func()
           ^^^^^^
  File "/app/etl/harvest/run.py", line 51, in process
    load_rows(monthly_rows)
  File "/app/etl/harvest/load.py", line 40, in load_rows
    harvest = _get_harvest_table(engine)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/etl/harvest/load.py", line 28, in _get_harvest_table
    return Table("harvest", md, autoload_with=engine)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in __new__
  File "/usr/local/lib/python3.12/site-packages/sqlalchemy/util/deprecations.py", line 281, in warned
    return fn(*args, **kwargs)  # type: ignore[no-any-return]
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/sqlalchemy/sql/schema.py", line 429, in __new__
    return cls._new(*args, **kw)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/sqlalchemy/sql/schema.py", line 483, in _new
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/usr/local/lib/python3.12/site-packages/sqlalchemy/sql/schema.py", line 479, in _new
    table.__init__(name, metadata, *args, _no_init=False, **kw)  # type: ignore[misc] # noqa: E501
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/sqlalchemy/sql/schema.py", line 861, in __init__
    self._autoload(
  File "/usr/local/lib/python3.12/site-packages/sqlalchemy/sql/schema.py", line 893, in _autoload
    conn_insp.reflect_table(
  File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/reflection.py", line 1548, in reflect_table
    raise exc.NoSuchTableError(table_name)
sqlalchemy.exc.NoSuchTableError: harvest
2026-02-16 08:55:07,354 | INFO | harvet_etl | ETL finished ok=0 ng=1
2026-02-16 09:09:05,024 | INFO | harvet_etl | start csv=test.csv
2026-02-16 09:09:05,033 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-16 09:09:05,033 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-16 09:09:05,043 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-16 09:09:05,050 | INFO | harvest_etl | validate done ok=2 quarantine=0
2026-02-16 09:09:05,050 | INFO | harvest_etl | quarantine load skipped: rows is empty
2026-02-16 09:09:05,050 | INFO | harvet_etl | rows summary csv=test.csv df=2ok=2 quarantine=0
2026-02-16 09:09:05,171 | INFO | harvest_etl | upserted rows=2
2026-02-16 09:09:05,171 | INFO | harvet_etl | success csv=test.csv
2026-02-16 09:09:05,172 | INFO | harvet_etl | ETL finished ok=1 ng=0
2026-02-17 13:06:52,396 | INFO | harvest_etl | start csv=test.csv
2026-02-17 13:06:54,398 | ERROR | harvest_etl | failed csv=test.csv reason=/mnt/csv/test.csv
Traceback (most recent call last):
  File "/app/etl/harvest/run.py", line 63, in run
    with_retry(process)
  File "/app/etl/common/retry.py", line 6, in with_retry
    return func()
           ^^^^^^
  File "/app/etl/harvest/run.py", line 31, in process
    df = extract_csv(csv_path)
         ^^^^^^^^^^^^^^^^^^^^^
  File "/app/etl/harvest/extract.py", line 47, in extract_csv
    raise FileNotFoundError(str(path))
FileNotFoundError: /mnt/csv/test.csv
2026-02-17 13:06:54,400 | INFO | harvest_etl | ETL finished ok=0 ng=1
2026-02-17 13:12:30,255 | INFO | harvest_etl | start csv=test.csv
2026-02-17 13:12:30,272 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-17 13:12:30,273 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-17 13:12:30,282 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-17 13:12:30,292 | INFO | harvest_etl | validate done ok=0 quarantine=2
2026-02-17 13:12:31,669 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-17 13:12:31,670 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-17 13:12:31,673 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-17 13:12:31,677 | INFO | harvest_etl | validate done ok=0 quarantine=2
2026-02-17 13:12:32,736 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-17 13:12:32,737 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-17 13:12:32,740 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-17 13:12:32,744 | INFO | harvest_etl | validate done ok=0 quarantine=2
2026-02-17 13:12:32,801 | ERROR | harvest_etl | failed csv=test.csv reason=Unconsumed column names: detail
Traceback (most recent call last):
  File "/app/etl/harvest/run.py", line 63, in run
    with_retry(process)
  File "/app/etl/common/retry.py", line 6, in with_retry
    return func()
           ^^^^^^
  File "/app/etl/harvest/run.py", line 41, in process
    load_quarantine_rows(quarantine_rows, source_file=csv_path.name)
  File "/app/etl/harvest/load.py", line 102, in load_quarantine_rows
    conn.execute(stmt)
  File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/usr/local/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1633, in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
                                                ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 729, in _compile_w_cache
    compiled_sql = self._compiler(
                   ^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 324, in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/sqlalchemy/sql/compiler.py", line 1448, in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
  File "/usr/local/lib/python3.12/site-packages/sqlalchemy/sql/compiler.py", line 888, in __init__
    self.string = self.process(self.statement, **compile_kwargs)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/sqlalchemy/sql/compiler.py", line 934, in process
    return obj._compiler_dispatch(self, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py", line 138, in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
           ^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/sqlalchemy/sql/compiler.py", line 5898, in visit_insert
    crud_params_struct = crud._get_crud_params(
                         ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/sqlalchemy/sql/crud.py", line 381, in _get_crud_params
    raise exc.CompileError(
sqlalchemy.exc.CompileError: Unconsumed column names: detail
2026-02-17 13:12:32,811 | INFO | harvest_etl | ETL finished ok=0 ng=1
2026-02-17 13:21:20,142 | INFO | harvest_etl | start csv=test.csv
2026-02-17 13:21:20,144 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-17 13:21:20,145 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-17 13:21:20,146 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-17 13:21:20,153 | INFO | harvest_etl | validate done ok=0 quarantine=2
2026-02-17 13:21:21,308 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-17 13:21:21,309 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-17 13:21:21,312 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-17 13:21:21,317 | INFO | harvest_etl | validate done ok=0 quarantine=2
2026-02-17 13:21:22,377 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-17 13:21:22,378 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-17 13:21:22,381 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-17 13:21:22,385 | INFO | harvest_etl | validate done ok=0 quarantine=2
2026-02-17 13:21:22,439 | ERROR | harvest_etl | failed csv=test.csv reason=name 'aloowed' is not defined
Traceback (most recent call last):
  File "/app/etl/harvest/run.py", line 63, in run
    with_retry(process)
  File "/app/etl/common/retry.py", line 6, in with_retry
    return func()
           ^^^^^^
  File "/app/etl/harvest/run.py", line 41, in process
    load_quarantine_rows(quarantine_rows, source_file=csv_path.name)
  File "/app/etl/harvest/load.py", line 107, in load_quarantine_rows
    extra = set(r.keys()) - aloowed
                            ^^^^^^^
NameError: name 'aloowed' is not defined. Did you mean: 'allowed'?
2026-02-17 13:21:22,441 | INFO | harvest_etl | ETL finished ok=0 ng=1
2026-02-17 13:22:09,604 | INFO | harvest_etl | start csv=test.csv
2026-02-17 13:22:09,606 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-17 13:22:09,607 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-17 13:22:09,608 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-17 13:22:09,616 | INFO | harvest_etl | validate done ok=0 quarantine=2
2026-02-17 13:22:10,745 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-17 13:22:10,747 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-17 13:22:10,749 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-17 13:22:10,754 | INFO | harvest_etl | validate done ok=0 quarantine=2
2026-02-17 13:22:11,817 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-17 13:22:11,818 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-17 13:22:11,821 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-17 13:22:11,825 | INFO | harvest_etl | validate done ok=0 quarantine=2
2026-02-17 13:22:11,885 | ERROR | harvest_etl | failed csv=test.csv reason=name 'alowed' is not defined
Traceback (most recent call last):
  File "/app/etl/harvest/run.py", line 63, in run
    with_retry(process)
  File "/app/etl/common/retry.py", line 6, in with_retry
    return func()
           ^^^^^^
  File "/app/etl/harvest/run.py", line 41, in process
    load_quarantine_rows(quarantine_rows, source_file=csv_path.name)
  File "/app/etl/harvest/load.py", line 107, in load_quarantine_rows
    extra = set(r.keys()) - alowed
                            ^^^^^^
NameError: name 'alowed' is not defined. Did you mean: 'allowed'?
2026-02-17 13:22:11,886 | INFO | harvest_etl | ETL finished ok=0 ng=1
2026-02-17 13:22:25,358 | INFO | harvest_etl | start csv=test.csv
2026-02-17 13:22:25,360 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-17 13:22:25,361 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-17 13:22:25,363 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-17 13:22:25,370 | INFO | harvest_etl | validate done ok=0 quarantine=2
2026-02-17 13:22:26,501 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-17 13:22:26,502 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-17 13:22:26,505 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-17 13:22:26,510 | INFO | harvest_etl | validate done ok=0 quarantine=2
2026-02-17 13:22:27,570 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-17 13:22:27,571 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-17 13:22:27,574 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-17 13:22:27,578 | INFO | harvest_etl | validate done ok=0 quarantine=2
2026-02-17 13:22:27,635 | ERROR | harvest_etl | failed csv=test.csv reason=quarantine row has extra keys idx=0 extra=['detail']
Traceback (most recent call last):
  File "/app/etl/harvest/run.py", line 63, in run
    with_retry(process)
  File "/app/etl/common/retry.py", line 6, in with_retry
    return func()
           ^^^^^^
  File "/app/etl/harvest/run.py", line 41, in process
    load_quarantine_rows(quarantine_rows, source_file=csv_path.name)
  File "/app/etl/harvest/load.py", line 109, in load_quarantine_rows
    raise RuntimeError(f"quarantine row has extra keys idx={i} extra={sorted(extra)}")
RuntimeError: quarantine row has extra keys idx=0 extra=['detail']
2026-02-17 13:22:27,636 | INFO | harvest_etl | ETL finished ok=0 ng=1
2026-02-17 13:37:28,458 | INFO | harvest_etl | start csv=test.csv
2026-02-17 13:37:28,460 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-17 13:37:28,461 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-17 13:37:28,462 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-17 13:37:28,470 | INFO | harvest_etl | validate done ok=0 quarantine=2
2026-02-17 13:37:28,607 | INFO | harvest_etl | inserted quarantine rows=2
2026-02-17 13:37:28,607 | INFO | harvest_etl | rows summary csv=test.csv df=2ok=0 quarantine=2
2026-02-17 13:37:28,608 | INFO | harvest_etl | load skipped: rows is empty
2026-02-17 13:37:29,609 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-17 13:37:29,610 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-17 13:37:29,613 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-17 13:37:29,619 | INFO | harvest_etl | validate done ok=0 quarantine=2
2026-02-17 13:37:29,702 | INFO | harvest_etl | inserted quarantine rows=2
2026-02-17 13:37:29,702 | INFO | harvest_etl | rows summary csv=test.csv df=2ok=0 quarantine=2
2026-02-17 13:37:29,702 | INFO | harvest_etl | load skipped: rows is empty
2026-02-17 13:37:30,703 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-17 13:37:30,705 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-17 13:37:30,707 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-17 13:37:30,713 | INFO | harvest_etl | validate done ok=0 quarantine=2
2026-02-17 13:37:30,793 | INFO | harvest_etl | inserted quarantine rows=2
2026-02-17 13:37:30,793 | INFO | harvest_etl | rows summary csv=test.csv df=2ok=0 quarantine=2
2026-02-17 13:37:30,794 | INFO | harvest_etl | load skipped: rows is empty
2026-02-17 13:37:30,794 | ERROR | harvest_etl | failed csv=test.csv reason=name 'load_rows' is not defined
Traceback (most recent call last):
  File "/app/etl/harvest/run.py", line 63, in run
    with_retry(process)
  File "/app/etl/common/retry.py", line 6, in with_retry
    return func()
           ^^^^^^
  File "/app/etl/harvest/run.py", line 61, in process
    load_rows(monthly_rows)
    ^^^^^^^^^
NameError: name 'load_rows' is not defined. Did you mean: 'ok_rows'?
2026-02-17 13:37:30,796 | INFO | harvest_etl | ETL finished ok=0 ng=1
2026-02-17 13:38:48,605 | INFO | harvest_etl | start csv=test.csv
2026-02-17 13:38:48,607 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-17 13:38:48,607 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-17 13:38:48,609 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-17 13:38:48,617 | INFO | harvest_etl | validate done ok=0 quarantine=2
2026-02-17 13:38:48,752 | INFO | harvest_etl | inserted quarantine rows=2
2026-02-17 13:38:48,753 | INFO | harvest_etl | rows summary csv=test.csv df=2ok=0 quarantine=2
2026-02-17 13:38:48,753 | INFO | harvest_etl | load skipped: rows is empty
2026-02-17 13:38:49,754 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-17 13:38:49,755 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-17 13:38:49,758 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-17 13:38:49,763 | INFO | harvest_etl | validate done ok=0 quarantine=2
2026-02-17 13:38:49,830 | INFO | harvest_etl | inserted quarantine rows=2
2026-02-17 13:38:49,830 | INFO | harvest_etl | rows summary csv=test.csv df=2ok=0 quarantine=2
2026-02-17 13:38:49,830 | INFO | harvest_etl | load skipped: rows is empty
2026-02-17 13:38:50,832 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-17 13:38:50,833 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-17 13:38:50,837 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-17 13:38:50,842 | INFO | harvest_etl | validate done ok=0 quarantine=2
2026-02-17 13:38:50,901 | INFO | harvest_etl | inserted quarantine rows=2
2026-02-17 13:38:50,901 | INFO | harvest_etl | rows summary csv=test.csv df=2ok=0 quarantine=2
2026-02-17 13:38:50,901 | INFO | harvest_etl | load skipped: rows is empty
2026-02-17 13:38:50,901 | ERROR | harvest_etl | failed csv=test.csv reason='list' object is not callable
Traceback (most recent call last):
  File "/app/etl/harvest/run.py", line 63, in run
    with_retry(process)
  File "/app/etl/common/retry.py", line 6, in with_retry
    return func()
           ^^^^^^
  File "/app/etl/harvest/run.py", line 61, in process
    ok_rows(monthly_rows)
TypeError: 'list' object is not callable
2026-02-17 13:38:50,902 | INFO | harvest_etl | ETL finished ok=0 ng=1
2026-02-17 13:40:22,229 | INFO | harvest_etl | start csv=test.csv
2026-02-17 13:40:22,231 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-17 13:40:22,232 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-17 13:40:22,234 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-17 13:40:22,242 | INFO | harvest_etl | validate done ok=0 quarantine=2
2026-02-17 13:40:22,376 | INFO | harvest_etl | inserted quarantine rows=2
2026-02-17 13:40:22,377 | INFO | harvest_etl | rows summary csv=test.csv df=2ok=0 quarantine=2
2026-02-17 13:40:22,377 | INFO | harvest_etl | load skipped: rows is empty
2026-02-17 13:40:23,378 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-17 13:40:23,378 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-17 13:40:23,380 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-17 13:40:23,384 | INFO | harvest_etl | validate done ok=0 quarantine=2
2026-02-17 13:40:23,448 | INFO | harvest_etl | inserted quarantine rows=2
2026-02-17 13:40:23,448 | INFO | harvest_etl | rows summary csv=test.csv df=2ok=0 quarantine=2
2026-02-17 13:40:23,448 | INFO | harvest_etl | load skipped: rows is empty
2026-02-17 13:40:24,450 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-17 13:40:24,451 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-17 13:40:24,454 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-17 13:40:24,459 | INFO | harvest_etl | validate done ok=0 quarantine=2
2026-02-17 13:40:24,521 | INFO | harvest_etl | inserted quarantine rows=2
2026-02-17 13:40:24,521 | INFO | harvest_etl | rows summary csv=test.csv df=2ok=0 quarantine=2
2026-02-17 13:40:24,521 | INFO | harvest_etl | load skipped: rows is empty
2026-02-17 13:40:24,521 | ERROR | harvest_etl | failed csv=test.csv reason=name 'load_rows' is not defined
Traceback (most recent call last):
  File "/app/etl/harvest/run.py", line 63, in run
    with_retry(process)
  File "/app/etl/common/retry.py", line 6, in with_retry
    return func()
           ^^^^^^
  File "/app/etl/harvest/run.py", line 61, in process
    load_rows(monthly_rows)
    ^^^^^^^^^
NameError: name 'load_rows' is not defined. Did you mean: 'ok_rows'?
2026-02-17 13:40:24,524 | INFO | harvest_etl | ETL finished ok=0 ng=1
2026-02-17 13:43:12,575 | INFO | harvest_etl | start csv=test.csv
2026-02-17 13:43:12,576 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-17 13:43:12,577 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-17 13:43:12,580 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-17 13:43:12,587 | INFO | harvest_etl | validate done ok=0 quarantine=2
2026-02-17 13:43:12,724 | INFO | harvest_etl | inserted quarantine rows=2
2026-02-17 13:43:12,724 | INFO | harvest_etl | rows summary csv=test.csv df=2ok=0 quarantine=2
2026-02-17 13:43:12,724 | INFO | harvest_etl | load skipped: rows is empty
2026-02-17 13:43:13,726 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-17 13:43:13,727 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-17 13:43:13,730 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-17 13:43:13,734 | INFO | harvest_etl | validate done ok=0 quarantine=2
2026-02-17 13:43:13,799 | INFO | harvest_etl | inserted quarantine rows=2
2026-02-17 13:43:13,799 | INFO | harvest_etl | rows summary csv=test.csv df=2ok=0 quarantine=2
2026-02-17 13:43:13,799 | INFO | harvest_etl | load skipped: rows is empty
2026-02-17 13:43:14,801 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-17 13:43:14,802 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-17 13:43:14,805 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-17 13:43:14,810 | INFO | harvest_etl | validate done ok=0 quarantine=2
2026-02-17 13:43:14,877 | INFO | harvest_etl | inserted quarantine rows=2
2026-02-17 13:43:14,877 | INFO | harvest_etl | rows summary csv=test.csv df=2ok=0 quarantine=2
2026-02-17 13:43:14,877 | INFO | harvest_etl | load skipped: rows is empty
2026-02-17 13:43:14,877 | ERROR | harvest_etl | failed csv=test.csv reason=name 'montly_rows' is not defined
Traceback (most recent call last):
  File "/app/etl/harvest/run.py", line 64, in run
    with_retry(process)
  File "/app/etl/common/retry.py", line 6, in with_retry
    return func()
           ^^^^^^
  File "/app/etl/harvest/run.py", line 61, in process
    logger.info(f"monthly_rows type={type(monthly_rows)} len={len(monthly_rows)} sample={montly_rows[:2]}")
                                                                                         ^^^^^^^^^^^
NameError: name 'montly_rows' is not defined. Did you mean: 'monthly_rows'?
2026-02-17 13:43:14,878 | INFO | harvest_etl | ETL finished ok=0 ng=1
2026-02-17 13:43:49,846 | INFO | harvest_etl | start csv=test.csv
2026-02-17 13:43:49,848 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-17 13:43:49,849 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-17 13:43:49,851 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-17 13:43:49,860 | INFO | harvest_etl | validate done ok=0 quarantine=2
2026-02-17 13:43:49,997 | INFO | harvest_etl | inserted quarantine rows=2
2026-02-17 13:43:49,997 | INFO | harvest_etl | rows summary csv=test.csv df=2ok=0 quarantine=2
2026-02-17 13:43:49,997 | INFO | harvest_etl | load skipped: rows is empty
2026-02-17 13:43:49,997 | INFO | harvest_etl | monthly_rows type=<class 'list'> len=0 sample=[]
2026-02-17 13:43:50,999 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-17 13:43:51,000 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-17 13:43:51,003 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-17 13:43:51,007 | INFO | harvest_etl | validate done ok=0 quarantine=2
2026-02-17 13:43:51,068 | INFO | harvest_etl | inserted quarantine rows=2
2026-02-17 13:43:51,068 | INFO | harvest_etl | rows summary csv=test.csv df=2ok=0 quarantine=2
2026-02-17 13:43:51,068 | INFO | harvest_etl | load skipped: rows is empty
2026-02-17 13:43:51,068 | INFO | harvest_etl | monthly_rows type=<class 'list'> len=0 sample=[]
2026-02-17 13:43:52,070 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-17 13:43:52,071 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-17 13:43:52,074 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-17 13:43:52,078 | INFO | harvest_etl | validate done ok=0 quarantine=2
2026-02-17 13:43:52,144 | INFO | harvest_etl | inserted quarantine rows=2
2026-02-17 13:43:52,144 | INFO | harvest_etl | rows summary csv=test.csv df=2ok=0 quarantine=2
2026-02-17 13:43:52,144 | INFO | harvest_etl | load skipped: rows is empty
2026-02-17 13:43:52,144 | INFO | harvest_etl | monthly_rows type=<class 'list'> len=0 sample=[]
2026-02-17 13:43:52,144 | ERROR | harvest_etl | failed csv=test.csv reason=name 'load_rows' is not defined
Traceback (most recent call last):
  File "/app/etl/harvest/run.py", line 64, in run
    with_retry(process)
  File "/app/etl/common/retry.py", line 6, in with_retry
    return func()
           ^^^^^^
  File "/app/etl/harvest/run.py", line 62, in process
    load_rows(monthly_rows)
    ^^^^^^^^^
NameError: name 'load_rows' is not defined. Did you mean: 'ok_rows'?
2026-02-17 13:43:52,147 | INFO | harvest_etl | ETL finished ok=0 ng=1
2026-02-21 00:25:27,395 | INFO | harvest_etl | start csv=test.csv
2026-02-21 00:25:27,412 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-21 00:25:27,413 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-21 00:25:27,422 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-21 00:25:27,431 | INFO | harvest_etl | validate done ok=0 quarantine=2
2026-02-21 00:25:28,433 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-21 00:25:28,434 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-21 00:25:28,437 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-21 00:25:28,441 | INFO | harvest_etl | validate done ok=0 quarantine=2
2026-02-21 00:25:29,443 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-21 00:25:29,444 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-21 00:25:29,447 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-21 00:25:29,451 | INFO | harvest_etl | validate done ok=0 quarantine=2
2026-02-21 00:25:29,451 | ERROR | harvest_etl | failed csv=test.csv reason=name 'os' is not defined
Traceback (most recent call last):
  File "/app/etl/harvest/run.py", line 167, in run
    with_retry(process)
  File "/app/etl/common/retry.py", line 6, in with_retry
    return func()
           ^^^^^^
  File "/app/etl/harvest/run.py", line 144, in process
    load_quarantine_rows(quarantine_rows, source_file=csv_path.name)
  File "/app/etl/harvest/run.py", line 85, in load_quarantine_rows
    engine = _get_engine()
             ^^^^^^^^^^^^^
  File "/app/etl/harvest/run.py", line 22, in _get_engine
    url = os.getenv("DATABASE_URL")
          ^^
NameError: name 'os' is not defined. Did you forget to import 'os'
2026-02-21 00:25:29,454 | INFO | harvest_etl | ETL finished ok=0 ng=1
2026-02-21 00:56:15,229 | INFO | harvest_etl | start csv=test.csv
2026-02-21 00:56:15,243 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-21 00:56:15,244 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-21 00:56:15,246 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-21 00:56:15,251 | INFO | harvest_etl | validate done ok=0 quarantine=2
2026-02-21 00:56:15,251 | INFO | harvest_etl | rows summary csv=test.csv df=2 ok=0 quarantine=2
2026-02-21 00:56:15,251 | INFO | harvest_etl | fact load skipped: rows is empty
2026-02-21 00:56:15,251 | INFO | harvest_etl | load skipped: rows is empty
2026-02-21 00:56:15,251 | INFO | harvest_etl | success csv=test.csv
2026-02-21 00:56:15,251 | INFO | harvest_etl | ETL finished ok=1 ng=0
2026-02-21 01:01:44,605 | INFO | harvest_etl | start csv=test.csv
2026-02-21 01:01:44,607 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-21 01:01:44,608 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-21 01:01:44,609 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-21 01:01:44,617 | INFO | harvest_etl | validate done ok=0 quarantine=2
2026-02-21 01:01:44,617 | INFO | harvest_etl | rows summary csv=test.csv df=2 ok=0 quarantine=2
2026-02-21 01:01:44,617 | INFO | harvest_etl | fact load skipped: rows is empty
2026-02-21 01:01:44,617 | INFO | harvest_etl | load skipped: rows is empty
2026-02-21 01:01:44,617 | INFO | harvest_etl | success csv=test.csv
2026-02-21 01:01:44,617 | INFO | harvest_etl | ETL finished ok=1 ng=0
2026-02-21 01:28:42,817 | INFO | harvest_etl | start csv=test.csv
2026-02-21 01:28:42,818 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-21 01:28:42,819 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-21 01:28:42,822 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-21 01:28:42,831 | INFO | harvest_etl | validate done ok=2 quarantine=0
2026-02-21 01:28:43,832 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-21 01:28:43,832 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-21 01:28:43,834 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-21 01:28:43,841 | INFO | harvest_etl | validate done ok=2 quarantine=0
2026-02-21 01:28:44,842 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-21 01:28:44,843 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-21 01:28:44,845 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-21 01:28:44,849 | INFO | harvest_etl | validate done ok=2 quarantine=0
2026-02-21 01:28:44,849 | ERROR | harvest_etl | failed csv=test.csv reason=name 'q' is not defined
Traceback (most recent call last):
  File "/app/etl/harvest/run.py", line 60, in run
    with_retry(process)
  File "/app/etl/common/retry.py", line 6, in with_retry
    return func()
           ^^^^^^
  File "/app/etl/harvest/run.py", line 37, in process
    load_quarantine_rows(quarantine_rows, source_file=csv_path.name)
  File "/app/etl/harvest/load.py", line 76, in load_quarantine_rows
    raw = getattr(q, "raw", None) or {}
                  ^
NameError: name 'q' is not defined
2026-02-21 01:28:44,851 | INFO | harvest_etl | ETL finished ok=0 ng=1
2026-02-21 01:48:15,215 | INFO | harvest_etl | start csv=test.csv
2026-02-21 01:48:15,216 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-21 01:48:15,217 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-21 01:48:15,220 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-21 01:48:15,227 | INFO | harvest_etl | validate done ok=2 quarantine=0
2026-02-21 01:48:15,227 | INFO | harvest_etl | quarantine load skipped: rows is empty
2026-02-21 01:48:15,227 | INFO | harvest_etl | rows summary csv=test.csv df=2 ok=2 quarantine=0
2026-02-21 01:48:16,229 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-21 01:48:16,230 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-21 01:48:16,232 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-21 01:48:16,237 | INFO | harvest_etl | validate done ok=2 quarantine=0
2026-02-21 01:48:16,238 | INFO | harvest_etl | quarantine load skipped: rows is empty
2026-02-21 01:48:16,238 | INFO | harvest_etl | rows summary csv=test.csv df=2 ok=2 quarantine=0
2026-02-21 01:48:17,240 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-21 01:48:17,241 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-21 01:48:17,244 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-21 01:48:17,248 | INFO | harvest_etl | validate done ok=2 quarantine=0
2026-02-21 01:48:17,249 | INFO | harvest_etl | quarantine load skipped: rows is empty
2026-02-21 01:48:17,249 | INFO | harvest_etl | rows summary csv=test.csv df=2 ok=2 quarantine=0
2026-02-21 01:48:17,249 | ERROR | harvest_etl | failed csv=test.csv reason=name 'a' is not defined
Traceback (most recent call last):
  File "/app/etl/harvest/run.py", line 60, in run
    with_retry(process)
  File "/app/etl/common/retry.py", line 6, in with_retry
    return func()
           ^^^^^^
  File "/app/etl/harvest/run.py", line 48, in process
    fact_rows = transform_fact_rows(
                ^^^^^^^^^^^^^^^^^^^^
  File "/app/etl/harvest/transform_fact.py", line 40, in transform_fact_rows
    row_hash = _sha256(payload)
               ^^^^^^^^^^^^^^^^
  File "/app/etl/harvest/transform_fact.py", line 11, in _sha256
    return hashlib.sha256(a.encode("utf-8")).hexdigest()
                          ^
NameError: name 'a' is not defined
2026-02-21 01:48:17,250 | INFO | harvest_etl | ETL finished ok=0 ng=1
2026-02-21 01:48:52,819 | INFO | harvest_etl | start csv=test.csv
2026-02-21 01:48:52,821 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-21 01:48:52,822 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-21 01:48:52,824 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-21 01:48:52,832 | INFO | harvest_etl | validate done ok=2 quarantine=0
2026-02-21 01:48:52,832 | INFO | harvest_etl | quarantine load skipped: rows is empty
2026-02-21 01:48:52,832 | INFO | harvest_etl | rows summary csv=test.csv df=2 ok=2 quarantine=0
2026-02-21 01:48:53,833 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-21 01:48:53,834 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-21 01:48:53,836 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-21 01:48:53,842 | INFO | harvest_etl | validate done ok=2 quarantine=0
2026-02-21 01:48:53,842 | INFO | harvest_etl | quarantine load skipped: rows is empty
2026-02-21 01:48:53,842 | INFO | harvest_etl | rows summary csv=test.csv df=2 ok=2 quarantine=0
2026-02-21 01:48:54,844 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-21 01:48:54,845 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-21 01:48:54,848 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-21 01:48:54,855 | INFO | harvest_etl | validate done ok=2 quarantine=0
2026-02-21 01:48:54,855 | INFO | harvest_etl | quarantine load skipped: rows is empty
2026-02-21 01:48:54,855 | INFO | harvest_etl | rows summary csv=test.csv df=2 ok=2 quarantine=0
2026-02-21 01:48:54,855 | ERROR | harvest_etl | failed csv=test.csv reason=name 'a' is not defined
Traceback (most recent call last):
  File "/app/etl/harvest/run.py", line 60, in run
    with_retry(process)
  File "/app/etl/common/retry.py", line 6, in with_retry
    return func()
           ^^^^^^
  File "/app/etl/harvest/run.py", line 48, in process
    fact_rows = transform_fact_rows(
                ^^^^^^^^^^^^^^^^^^^^
  File "/app/etl/harvest/transform_fact.py", line 40, in transform_fact_rows
    row_hash = _sha256(payload)
               ^^^^^^^^^^^^^^^^
  File "/app/etl/harvest/transform_fact.py", line 11, in _sha256
    return hashlib.sha256(a.encode("utf-8")).hexdigest()
                          ^
NameError: name 'a' is not defined
2026-02-21 01:48:54,857 | INFO | harvest_etl | ETL finished ok=0 ng=1
2026-02-21 01:51:20,470 | INFO | harvest_etl | start csv=test.csv
2026-02-21 01:51:20,471 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-21 01:51:20,472 | WARNING | harvest_etl | read_csv failed file=test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-02-21 01:51:20,474 | INFO | harvest_etl | read_csv_file=test.csv encoding=utf-8-sig rows=2 cols=4
2026-02-21 01:51:20,482 | INFO | harvest_etl | validate done ok=2 quarantine=0
2026-02-21 01:51:20,482 | INFO | harvest_etl | quarantine load skipped: rows is empty
2026-02-21 01:51:20,482 | INFO | harvest_etl | rows summary csv=test.csv df=2 ok=2 quarantine=0
2026-02-21 01:51:20,800 | INFO | harvest_etl | inserted fact rows=2
2026-02-21 01:51:20,859 | INFO | harvest_etl | upserted rows=2
2026-02-21 01:51:20,859 | INFO | harvest_etl | success csv=test.csv
2026-02-21 01:51:20,859 | INFO | harvest_etl | ETL finished ok=1 ng=0
