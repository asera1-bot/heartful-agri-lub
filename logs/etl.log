2026-01-31 11:51:08,436 | INFO | harvest_etl | start csv=harvest_test.csv
2026-01-31 11:51:08,449 | WARNING | harvest_etl | read_csv failed file=harvest_test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-01-31 11:51:08,453 | WARNING | harvest_etl | read_csv failed file=harvest_test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-01-31 11:51:08,461 | INFO | harvest_etl | read_csv_file=harvest_test.csv encoding=utf-8-sig rows=2 cols=4
2026-01-31 11:51:08,479 | WARNING | harvest_etl | now skipped idx=0 reason=2 validation errors for HarvestCsvRow
harvest_date
  Input should be a valid date or datetime, invalid date separator, expected `-` [type=date_from_datetime_parsing, input_value='2025/08/01', input_type=str]
    For further information visit https://errors.pydantic.dev/2.12/v/date_from_datetime_parsing
crop
  Field required [type=missing, input_value={'harvest_date': '2025/08...ド', 'amount_g': 1000}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.12/v/missing
2026-01-31 11:51:08,479 | WARNING | harvest_etl | now skipped idx=1 reason=2 validation errors for HarvestCsvRow
harvest_date
  Input should be a valid date or datetime, invalid date separator, expected `-` [type=date_from_datetime_parsing, input_value='2025/08/01', input_type=str]
    For further information visit https://errors.pydantic.dev/2.12/v/date_from_datetime_parsing
crop
  Field required [type=missing, input_value={'harvest_date': '2025/08...ル', 'amount_g': 500}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.12/v/missing
2026-01-31 11:51:08,479 | ERROR | harvest_etl | failed csv=harvest_test.csv reason=name 'retires' is not defined
Traceback (most recent call last):
  File "/home/asera1231/harvest_ETL/etl/common/retry.py", line 6, in with_retry
    return func()
           ^^^^^^
  File "/home/asera1231/harvest_ETL/etl/harvest/run.py", line 36, in process
    raise ValueError("no valid rows")
ValueError: no valid rows

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/asera1231/harvest_ETL/etl/harvest/run.py", line 44, in run
    with_retry(process)
  File "/home/asera1231/harvest_ETL/etl/common/retry.py", line 8, in with_retry
    if attempt == retires:
                  ^^^^^^^
NameError: name 'retires' is not defined. Did you mean: 'retries'?
2026-01-31 11:51:08,482 | WARNING | harvest_etl | mv skipped ok=0 ng=1
2026-01-31 11:51:08,483 | INFO | harvest_etl | ETL finished ok=0 ng=1
2026-01-31 11:52:03,045 | INFO | harvest_etl | start csv=harvest_test.csv
2026-01-31 11:52:03,047 | WARNING | harvest_etl | read_csv failed file=harvest_test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-01-31 11:52:03,047 | WARNING | harvest_etl | read_csv failed file=harvest_test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-01-31 11:52:03,048 | INFO | harvest_etl | read_csv_file=harvest_test.csv encoding=utf-8-sig rows=2 cols=4
2026-01-31 11:52:03,050 | WARNING | harvest_etl | now skipped idx=0 reason=2 validation errors for HarvestCsvRow
harvest_date
  Input should be a valid date or datetime, invalid date separator, expected `-` [type=date_from_datetime_parsing, input_value='2025/08/01', input_type=str]
    For further information visit https://errors.pydantic.dev/2.12/v/date_from_datetime_parsing
crop
  Field required [type=missing, input_value={'harvest_date': '2025/08...ド', 'amount_g': 1000}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.12/v/missing
2026-01-31 11:52:03,050 | WARNING | harvest_etl | now skipped idx=1 reason=2 validation errors for HarvestCsvRow
harvest_date
  Input should be a valid date or datetime, invalid date separator, expected `-` [type=date_from_datetime_parsing, input_value='2025/08/01', input_type=str]
    For further information visit https://errors.pydantic.dev/2.12/v/date_from_datetime_parsing
crop
  Field required [type=missing, input_value={'harvest_date': '2025/08...ル', 'amount_g': 500}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.12/v/missing
2026-01-31 11:52:04,051 | WARNING | harvest_etl | read_csv failed file=harvest_test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-01-31 11:52:04,051 | WARNING | harvest_etl | read_csv failed file=harvest_test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-01-31 11:52:04,052 | INFO | harvest_etl | read_csv_file=harvest_test.csv encoding=utf-8-sig rows=2 cols=4
2026-01-31 11:52:04,053 | WARNING | harvest_etl | now skipped idx=0 reason=2 validation errors for HarvestCsvRow
harvest_date
  Input should be a valid date or datetime, invalid date separator, expected `-` [type=date_from_datetime_parsing, input_value='2025/08/01', input_type=str]
    For further information visit https://errors.pydantic.dev/2.12/v/date_from_datetime_parsing
crop
  Field required [type=missing, input_value={'harvest_date': '2025/08...ド', 'amount_g': 1000}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.12/v/missing
2026-01-31 11:52:04,053 | WARNING | harvest_etl | now skipped idx=1 reason=2 validation errors for HarvestCsvRow
harvest_date
  Input should be a valid date or datetime, invalid date separator, expected `-` [type=date_from_datetime_parsing, input_value='2025/08/01', input_type=str]
    For further information visit https://errors.pydantic.dev/2.12/v/date_from_datetime_parsing
crop
  Field required [type=missing, input_value={'harvest_date': '2025/08...ル', 'amount_g': 500}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.12/v/missing
2026-01-31 11:52:05,054 | WARNING | harvest_etl | read_csv failed file=harvest_test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-01-31 11:52:05,055 | WARNING | harvest_etl | read_csv failed file=harvest_test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-01-31 11:52:05,057 | INFO | harvest_etl | read_csv_file=harvest_test.csv encoding=utf-8-sig rows=2 cols=4
2026-01-31 11:52:05,058 | WARNING | harvest_etl | now skipped idx=0 reason=2 validation errors for HarvestCsvRow
harvest_date
  Input should be a valid date or datetime, invalid date separator, expected `-` [type=date_from_datetime_parsing, input_value='2025/08/01', input_type=str]
    For further information visit https://errors.pydantic.dev/2.12/v/date_from_datetime_parsing
crop
  Field required [type=missing, input_value={'harvest_date': '2025/08...ド', 'amount_g': 1000}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.12/v/missing
2026-01-31 11:52:05,058 | WARNING | harvest_etl | now skipped idx=1 reason=2 validation errors for HarvestCsvRow
harvest_date
  Input should be a valid date or datetime, invalid date separator, expected `-` [type=date_from_datetime_parsing, input_value='2025/08/01', input_type=str]
    For further information visit https://errors.pydantic.dev/2.12/v/date_from_datetime_parsing
crop
  Field required [type=missing, input_value={'harvest_date': '2025/08...ル', 'amount_g': 500}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.12/v/missing
2026-01-31 11:52:05,058 | ERROR | harvest_etl | failed csv=harvest_test.csv reason=no valid rows
Traceback (most recent call last):
  File "/home/asera1231/harvest_ETL/etl/harvest/run.py", line 44, in run
    with_retry(process)
  File "/home/asera1231/harvest_ETL/etl/common/retry.py", line 6, in with_retry
    return func()
           ^^^^^^
  File "/home/asera1231/harvest_ETL/etl/harvest/run.py", line 36, in process
    raise ValueError("no valid rows")
ValueError: no valid rows
2026-01-31 11:52:05,059 | WARNING | harvest_etl | mv skipped ok=0 ng=1
2026-01-31 11:52:05,059 | INFO | harvest_etl | ETL finished ok=0 ng=1
2026-01-31 12:17:35,548 | INFO | harvest_etl | start csv=harvest_test.csv
2026-01-31 12:17:35,558 | WARNING | harvest_etl | read_csv failed file=harvest_test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-01-31 12:17:35,560 | WARNING | harvest_etl | read_csv failed file=harvest_test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-01-31 12:17:35,568 | INFO | harvest_etl | read_csv_file=harvest_test.csv encoding=utf-8-sig rows=2 cols=4
2026-01-31 12:17:36,570 | WARNING | harvest_etl | read_csv failed file=harvest_test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-01-31 12:17:36,570 | WARNING | harvest_etl | read_csv failed file=harvest_test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-01-31 12:17:36,572 | INFO | harvest_etl | read_csv_file=harvest_test.csv encoding=utf-8-sig rows=2 cols=4
2026-01-31 12:17:37,573 | WARNING | harvest_etl | read_csv failed file=harvest_test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-01-31 12:17:37,573 | WARNING | harvest_etl | read_csv failed file=harvest_test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-01-31 12:17:37,574 | INFO | harvest_etl | read_csv_file=harvest_test.csv encoding=utf-8-sig rows=2 cols=4
2026-01-31 12:17:37,575 | ERROR | harvest_etl | failed csv=harvest_test.csv reason=name 'mpping' is not defined
Traceback (most recent call last):
  File "/home/asera1231/harvest_ETL/etl/harvest/run.py", line 47, in run
    with_retry(process)
  File "/home/asera1231/harvest_ETL/etl/common/retry.py", line 6, in with_retry
    return func()
           ^^^^^^
  File "/home/asera1231/harvest_ETL/etl/harvest/run.py", line 27, in process
    df = df.rename(columns=rename_columns(list(df.columns)))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/asera1231/harvest_ETL/etl/harvest/colmap.py", line 32, in rename_columns
    return mpping
           ^^^^^^
NameError: name 'mpping' is not defined. Did you mean: 'mapping'?
2026-01-31 12:17:37,588 | WARNING | harvest_etl | mv skipped ok=0 ng=1
2026-01-31 12:17:37,588 | INFO | harvest_etl | ETL finished ok=0 ng=1
2026-01-31 12:18:05,166 | INFO | harvest_etl | start csv=harvest_test.csv
2026-01-31 12:18:05,168 | WARNING | harvest_etl | read_csv failed file=harvest_test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-01-31 12:18:05,168 | WARNING | harvest_etl | read_csv failed file=harvest_test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-01-31 12:18:05,169 | INFO | harvest_etl | read_csv_file=harvest_test.csv encoding=utf-8-sig rows=2 cols=4
2026-01-31 12:18:05,498 | INFO | harvest_etl | upserted rows=2
2026-01-31 12:18:05,498 | INFO | harvest_etl | success csv=harvest_test.csv
2026-01-31 12:18:05,498 | INFO | harvest_etl | refresh_mv: skipped (not implemented yet)
2026-01-31 12:18:05,498 | INFO | harvest_etl | mv refreshed
2026-01-31 12:18:05,498 | INFO | harvest_etl | ETL finished ok=1 ng=0
2026-01-31 12:47:37,284 | INFO | harvest_etl | start csv=harvest_test.csv
2026-01-31 12:47:37,294 | WARNING | harvest_etl | read_csv failed file=harvest_test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-01-31 12:47:37,296 | WARNING | harvest_etl | read_csv failed file=harvest_test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-01-31 12:47:37,303 | INFO | harvest_etl | read_csv_file=harvest_test.csv encoding=utf-8-sig rows=2 cols=4
2026-01-31 12:47:37,628 | INFO | harvest_etl | upserted rows=2
2026-01-31 12:47:37,629 | INFO | harvest_etl | success csv=harvest_test.csv
2026-01-31 12:47:37,677 | INFO | harvest_etl | refresh_mv done concurrenlty=False
2026-01-31 12:48:47,952 | INFO | harvest_etl | start csv=harvest_test.csv
2026-01-31 12:48:47,960 | WARNING | harvest_etl | read_csv failed file=harvest_test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-01-31 12:48:47,962 | WARNING | harvest_etl | read_csv failed file=harvest_test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-01-31 12:48:47,969 | INFO | harvest_etl | read_csv_file=harvest_test.csv encoding=utf-8-sig rows=2 cols=4
2026-01-31 12:48:48,275 | INFO | harvest_etl | upserted rows=2
2026-01-31 12:48:48,276 | INFO | harvest_etl | success csv=harvest_test.csv
2026-01-31 12:48:48,320 | INFO | harvest_etl | refresh_mv done concurrenlty=False
2026-01-31 12:49:31,044 | INFO | harvest_etl | start csv=harvest_test.csv
2026-01-31 12:49:31,053 | WARNING | harvest_etl | read_csv failed file=harvest_test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-01-31 12:49:31,055 | WARNING | harvest_etl | read_csv failed file=harvest_test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-01-31 12:49:31,062 | INFO | harvest_etl | read_csv_file=harvest_test.csv encoding=utf-8-sig rows=2 cols=4
2026-01-31 12:49:31,385 | INFO | harvest_etl | upserted rows=2
2026-01-31 12:49:31,385 | INFO | harvest_etl | success csv=harvest_test.csv
2026-01-31 12:49:31,422 | INFO | harvest_etl | refresh_mv done concurrenlty=False
2026-01-31 12:51:24,801 | INFO | harvest_etl | start csv=harvest_test.csv
2026-01-31 12:51:24,808 | WARNING | harvest_etl | read_csv failed file=harvest_test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-01-31 12:51:24,810 | WARNING | harvest_etl | read_csv failed file=harvest_test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x8d in position 18: illegal multibyte sequence
2026-01-31 12:51:24,817 | INFO | harvest_etl | read_csv_file=harvest_test.csv encoding=utf-8-sig rows=2 cols=4
2026-01-31 12:51:25,119 | INFO | harvest_etl | upserted rows=2
2026-01-31 12:51:25,119 | INFO | harvest_etl | success csv=harvest_test.csv
2026-01-31 12:51:25,173 | INFO | harvest_etl | refresh_mv done concurrenlty=False
2026-01-31 12:51:25,173 | INFO | harvest_etl | ETL finished ok=1 ng=0
2026-01-31 18:01:57,586 | INFO | harvest_etl | start csv=harvest_test.csv
2026-01-31 18:01:59,588 | ERROR | harvest_etl | failed csv=harvest_test.csv reason=/tmp/harvest_test.csv
Traceback (most recent call last):
  File "/home/asera1231/harvest_ETL/etl/harvest/run.py", line 47, in run
    with_retry(process)
  File "/home/asera1231/harvest_ETL/etl/common/retry.py", line 6, in with_retry
    return func()
           ^^^^^^
  File "/home/asera1231/harvest_ETL/etl/harvest/run.py", line 26, in process
    df = extract_csv(csv_path)
         ^^^^^^^^^^^^^^^^^^^^^
  File "/home/asera1231/harvest_ETL/etl/harvest/extract.py", line 47, in extract_csv
    raise FileNotFoundError(str(path))
FileNotFoundError: /tmp/harvest_test.csv
2026-01-31 18:01:59,591 | WARNING | harvest_etl | mv skipped ok=0 ng=1
2026-01-31 18:01:59,591 | INFO | harvest_etl | ETL finished ok=0 ng=1
2026-01-31 18:03:55,789 | INFO | harvest_etl | start csv=harvest_test.csv
2026-01-31 18:03:55,803 | WARNING | harvest_etl | read_csv failed file=harvest_test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x83 in position 60: illegal multibyte sequence
2026-01-31 18:03:55,806 | WARNING | harvest_etl | read_csv failed file=harvest_test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x83 in position 60: illegal multibyte sequence
2026-01-31 18:03:55,815 | INFO | harvest_etl | read_csv_file=harvest_test.csv encoding=utf-8-sig rows=2 cols=4
2026-01-31 18:03:56,153 | INFO | harvest_etl | upserted rows=2
2026-01-31 18:03:56,153 | INFO | harvest_etl | success csv=harvest_test.csv
2026-01-31 18:04:15,576 | INFO | harvest_etl | start csv=harvest_test.csv
2026-01-31 18:04:15,578 | WARNING | harvest_etl | read_csv failed file=harvest_test.csv encoding=cp932 reason='cp932' codec can't decode byte 0x83 in position 60: illegal multibyte sequence
2026-01-31 18:04:15,578 | WARNING | harvest_etl | read_csv failed file=harvest_test.csv encoding=shift_jis reason='shift_jis' codec can't decode byte 0x83 in position 60: illegal multibyte sequence
2026-01-31 18:04:15,580 | INFO | harvest_etl | read_csv_file=harvest_test.csv encoding=utf-8-sig rows=2 cols=4
2026-01-31 18:04:15,734 | INFO | harvest_etl | upserted rows=2
2026-01-31 18:04:15,735 | INFO | harvest_etl | success csv=harvest_test.csv
2026-01-31 18:04:15,807 | INFO | harvest_etl | refresh_mv done concurrently=True
2026-01-31 18:04:15,807 | INFO | harvest_etl | ETL finished ok=1 ng=0
